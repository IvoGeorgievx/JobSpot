generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  ADMIN
  COMPANY
  APPLICANT
}

enum JobType {
  FULL_TIME
  PART_TIME
  CONTRACT
  TEMPORARY
  INTERN
  FREELANCE
}

enum ApplicationStatus {
  APPLIED
  REVIEWED
  REJECTED
}

model User {
  id               String            @id @default(uuid())
  email            String            @unique
  password         String
  role             UserRole
  companyProfile   CompanyProfile?
  applicantProfile ApplicantProfile?
}

model CompanyProfile {
  id            String       @id @default(uuid())
  userId        String       @unique
  user          User         @relation(fields: [userId], references: [id])
  jobPosting    JobPosting[]
  name          String?
  details       String?
  field         String?
  profilePicUrl String?
}

model JobPosting {
  id               String           @id @default(uuid())
  companyProfile   CompanyProfile   @relation(fields: [companyProfileId], references: [id])
  companyProfileId String
  title            String
  description      String
  field            String
  jobType          JobType
  createdAt        DateTime         @default(now())
  requirements     String
  responsibilities String
  salaryMin        Int?
  salaryMax        Int?
  JobApplication   JobApplication[]
}

model ApplicantProfile {
  id             String           @id @default(uuid())
  userId         String           @unique
  user           User             @relation(fields: [userId], references: [id])
  phone          String?
  fullName       String?
  cvUrl          String?
  profilePicUrl  String?
  JobApplication JobApplication[]
}

model JobApplication {
  id                 String            @id @default(uuid())
  jobPostingId       String
  jobPosting         JobPosting        @relation(fields: [jobPostingId], references: [id])
  applicantProfileId String
  applicantProfile   ApplicantProfile  @relation(fields: [applicantProfileId], references: [id])
  status             ApplicationStatus @default(APPLIED)

  @@unique([jobPostingId, applicantProfileId])
}
